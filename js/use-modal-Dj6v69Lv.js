var Je=Object.defineProperty,Ge=Object.defineProperties;var Qe=Object.getOwnPropertyDescriptors;var Q=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable;var de=(s,o,t)=>o in s?Je(s,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[o]=t,f=(s,o)=>{for(var t in o||(o={}))be.call(o,t)&&de(s,t,o[t]);if(Q)for(var t of Q(o))Ce.call(o,t)&&de(s,t,o[t]);return s},I=(s,o)=>Ge(s,Qe(o));var R=(s,o)=>{var t={};for(var n in s)be.call(s,n)&&o.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&Q)for(var n of Q(s))o.indexOf(n)<0&&Ce.call(s,n)&&(t[n]=s[n]);return t};var X=(s,o,t)=>de(s,typeof o!="symbol"?o+"":o,t);var N=(s,o,t)=>new Promise((n,i)=>{var c=m=>{try{C(t.next(m))}catch(a){i(a)}},u=m=>{try{C(t.throw(m))}catch(a){i(a)}},C=m=>m.done?n(m.value):Promise.resolve(m.value).then(c,u);C((t=t.apply(s,o)).next())});import{e as M,v as h,j as p,u as e,V as Ze,W as eo,I as y,p as b,B as xe,h as ue,c as T,r as _,y as F,k,q as oo,n as L,m as O,X as pe,J as De,o as to,$ as so,af as no,aw as ce,at as ao,w as lo,l as ro,x as Y,t as H,H as Be,s as fe,ae as $e,au as io,a as co,av as uo,K as ke}from"../jse/index-index-CClcjv6z.js";import{b as Ae,X as Se,b2 as po,b4 as fo,b5 as mo,as as ho,b3 as yo,b6 as vo,ax as Te,b7 as go,b8 as bo,b9 as Co,ba as Bo,bb as ko,bc as wo,bd as _o,be as Oo,bf as Mo,b0 as xo,k as we,bg as Do,bh as $o}from"./bootstrap-DKNppDM-.js";import{X as Ao}from"./x-D_Pq9Xi1.js";import{V as So}from"./loading-CMDzNo7D.js";const To=Ae("expand",[["path",{d:"m15 15 6 6",key:"1s409w"}],["path",{d:"m15 9 6-6",key:"ko1vev"}],["path",{d:"M21 16v5h-5",key:"1ck2sf"}],["path",{d:"M21 8V3h-5",key:"1qoq8a"}],["path",{d:"M3 16v5h5",key:"1t08am"}],["path",{d:"m3 21 6-6",key:"wwnumi"}],["path",{d:"M3 8V3h5",key:"1ln10m"}],["path",{d:"M9 9 3 3",key:"v551iv"}]]);const Eo=Ae("shrink",[["path",{d:"m15 15 6 6m-6-6v4.8m0-4.8h4.8",key:"17vawe"}],["path",{d:"M9 19.8V15m0 0H4.2M9 15l-6 6",key:"chjx8e"}],["path",{d:"M15 4.2V9m0 0h4.8M15 9l6-6",key:"lav6yq"}],["path",{d:"M9 4.2V9m0 0H4.2M9 9 3 3",key:"1pxi2q"}]]),Io=M({__name:"Dialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(s,{emit:o}){const i=Se(s,o);return(c,u)=>(p(),h(e(po),Ze(eo(e(i))),{default:y(()=>[b(c.$slots,"default")]),_:3},16))}}),Lo=["data-dismissable-modal"],Po=M({__name:"DialogOverlay",setup(s){fo();const o=xe("DISMISSABLE_MODAL_ID");return(t,n)=>(p(),ue("div",{"data-dismissable-modal":e(o),class:"bg-overlay z-popup inset-0"},null,8,Lo))}}),zo=M({__name:"DialogContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},appendTo:{default:"body"},class:{},closeClass:{},closeDisabled:{type:Boolean,default:!1},modal:{type:Boolean},open:{type:Boolean},overlayBlur:{},showClose:{type:Boolean,default:!0},zIndex:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus","close","closed","opened"],setup(s,{expose:o,emit:t}){const n=s,i=t,c=T(()=>{const x=n,{class:r,modal:d,open:B,showClose:w}=x;return R(x,["class","modal","open","showClose"])});function u(){return n.appendTo==="body"||n.appendTo===document.body||!n.appendTo}const C=T(()=>u()?"fixed":"absolute"),m=Se(c,i),a=_(null);function v(r){var d;r.target===((d=a.value)==null?void 0:d.$el)&&(n.open?i("opened"):i("closed"))}return o({getContentRef:()=>a.value}),(r,d)=>(p(),h(e(mo),{to:r.appendTo},{default:y(()=>[F(ho,{name:"fade"},{default:y(()=>[r.open&&r.modal?(p(),h(Po,{key:0,style:oo(I(f({},r.zIndex?{zIndex:r.zIndex}:{}),{position:C.value,backdropFilter:r.overlayBlur&&r.overlayBlur>0?`blur(${r.overlayBlur}px)`:"none"})),onClick:d[0]||(d[0]=()=>i("close"))},null,8,["style"])):k("",!0)]),_:1}),F(e(vo),pe({ref_key:"contentRef",ref:a,style:I(f({},r.zIndex?{zIndex:r.zIndex}:{}),{position:C.value}),onAnimationend:v},e(m),{class:e(O)("z-popup bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-top-[48%] w-full p-6 shadow-lg outline-none sm:rounded-xl",n.class)}),{default:y(()=>[b(r.$slots,"default"),r.showClose?(p(),h(e(yo),{key:0,disabled:r.closeDisabled,class:L(e(O)("data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:bg-accent hover:text-accent-foreground text-foreground/80 flex-center absolute right-3 top-3 h-6 w-6 rounded-full px-1 text-lg opacity-70 transition-opacity hover:opacity-100 focus:outline-none disabled:pointer-events-none",n.closeClass)),onClick:d[1]||(d[1]=()=>i("close"))},{default:y(()=>[F(e(Ao),{class:"h-4 w-4"})]),_:1},8,["disabled","class"])):k("",!0)]),_:3},16,["style","class"])]),_:3},8,["to"]))}}),_e=M({__name:"DialogDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(s){const o=s,t=T(()=>{const u=o,{class:i}=u;return R(u,["class"])}),n=Te(t);return(i,c)=>(p(),h(e(go),pe(e(n),{class:e(O)("text-muted-foreground text-sm",o.class)}),{default:y(()=>[b(i.$slots,"default")]),_:3},16,["class"]))}}),Vo=M({__name:"DialogFooter",props:{class:{}},setup(s){const o=s;return(t,n)=>(p(),ue("div",{class:L(e(O)("flex flex-row flex-col-reverse justify-end gap-x-2",o.class))},[b(t.$slots,"default")],2))}}),Fo=M({__name:"DialogHeader",props:{class:{}},setup(s){const o=s;return(t,n)=>(p(),ue("div",{class:L(e(O)("flex flex-col gap-y-1.5 text-center sm:text-left",o.class))},[b(t.$slots,"default")],2))}}),Oe=M({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(s){const o=s,t=T(()=>{const u=o,{class:i}=u;return R(u,["class"])}),n=Te(t);return(i,c)=>(p(),h(e(bo),pe(e(n),{class:e(O)("text-lg font-semibold leading-none tracking-tight",o.class)}),{default:y(()=>[b(i.$slots,"default")]),_:3},16,["class"]))}});function Ro(s,o,t){const n=De({offsetX:0,offsetY:0}),i=_(!1),c=a=>{const v=a.clientX,r=a.clientY;if(!s.value)return;const d=s.value.getBoundingClientRect(),{offsetX:B,offsetY:w}=n,$=d.left,x=d.top,Z=d.width,j=d.height,K=document.documentElement,ee=K.clientWidth,oe=K.clientHeight,te=-$+B,se=-x+w,P=ee-$-Z+B,ne=oe-x-j+w,q=W=>{let A=B+W.clientX-v,z=w+W.clientY-r;A=Math.min(Math.max(A,te),P),z=Math.min(Math.max(z,se),ne),n.offsetX=A,n.offsetY=z,s.value&&(s.value.style.transform=`translate(${A}px, ${z}px)`,i.value=!0)},U=()=>{i.value=!1,document.removeEventListener("mousemove",q),document.removeEventListener("mouseup",U)};document.addEventListener("mousemove",q),document.addEventListener("mouseup",U)},u=()=>{const a=ce(o);a&&s.value&&a.addEventListener("mousedown",c)},C=()=>{const a=ce(o);a&&s.value&&a.removeEventListener("mousedown",c)},m=()=>{n.offsetX=0,n.offsetY=0;const a=ce(s);a&&(a.style.transform="none")};return to(()=>{so(()=>{t.value?u():C()})}),no(()=>{C()}),{dragging:i,resetPosition:m,transform:n}}const Xo=M({__name:"modal",props:{modalApi:{default:void 0},appendToMain:{type:Boolean,default:!1},bordered:{type:Boolean},cancelText:{},centered:{type:Boolean},class:{},closable:{type:Boolean},closeOnClickModal:{type:Boolean},closeOnPressEscape:{type:Boolean},confirmDisabled:{type:Boolean},confirmLoading:{type:Boolean},confirmText:{},contentClass:{},description:{},destroyOnClose:{type:Boolean,default:!1},draggable:{type:Boolean},footer:{type:Boolean},footerClass:{},fullscreen:{type:Boolean},fullscreenButton:{type:Boolean},header:{type:Boolean},headerClass:{},loading:{type:Boolean},modal:{type:Boolean},openAutoFocus:{type:Boolean},overlayBlur:{},showCancelButton:{type:Boolean},showConfirmButton:{type:Boolean},submitting:{type:Boolean},title:{},titleTooltip:{},zIndex:{}},setup(s){var G,ge;const o=s,t=Co.getComponents(),n=_(),i=_(),c=_(),u=_(),C=_(),m=ao();$e("DISMISSABLE_MODAL_ID",m);const{$t:a}=Bo(),{isMobile:v}=ko(),r=(ge=(G=o.modalApi)==null?void 0:G.useStore)==null?void 0:ge.call(G),{appendToMain:d,bordered:B,cancelText:w,centered:$,class:x,closable:Z,closeOnClickModal:j,closeOnPressEscape:K,confirmDisabled:ee,confirmLoading:oe,confirmText:te,contentClass:se,description:P,destroyOnClose:ne,draggable:q,footer:U,footerClass:W,fullscreen:A,fullscreenButton:z,header:ae,headerClass:Ee,loading:me,modal:Ie,openAutoFocus:Le,overlayBlur:Pe,showCancelButton:ze,showConfirmButton:Ve,submitting:D,title:J,titleTooltip:he,zIndex:Fe}=wo(o,r),le=T(()=>A.value&&ae.value||v.value),ye=T(()=>q.value&&!le.value&&ae.value),{dragging:Re,transform:Xe}=Ro(c,u,ye),re=_(!1),ie=_(!0);lo(()=>{var l;return(l=r==null?void 0:r.value)==null?void 0:l.isOpen},l=>N(null,null,function*(){if(l){if(ie.value=!1,re.value||(re.value=!0),yield fe(),!n.value)return;const g=n.value.getContentRef();c.value=g.$el;const{offsetX:V,offsetY:E}=Xe;c.value.style.transform=`translate(${V}px, ${E}px)`}}),{immediate:!0});function Ne(){var l;(l=o.modalApi)==null||l.setState(g=>I(f({},g),{fullscreen:!A.value}))}function Ye(l){(!j.value||D.value)&&(l.preventDefault(),l.stopPropagation())}function He(l){(!K.value||D.value)&&l.preventDefault()}function je(l){Le.value||l==null||l.preventDefault()}function Ke(l){const g=l.target,V=g==null?void 0:g.dataset.dismissableModal;(!j.value||V!==m||D.value)&&(l.preventDefault(),l.stopPropagation())}function ve(l){l.preventDefault(),l.stopPropagation()}const qe=T(()=>d.value?`#${_o}>div:not(.absolute)>div`:void 0),Ue=T(()=>!e(ne)&&e(re));function We(){var l;ie.value=!0,(l=o.modalApi)==null||l.onClosed()}return(l,g)=>{var V;return p(),h(e(Io),{modal:!1,open:(V=e(r))==null?void 0:V.isOpen,"onUpdate:open":g[3]||(g[3]=()=>{var E;return e(D)||(E=l.modalApi)==null?void 0:E.close()})},{default:y(()=>{var E;return[F(e(zo),{ref_key:"contentRef",ref:n,"append-to":qe.value,class:L(e(O)("left-0 right-0 top-[10vh] mx-auto flex max-h-[80%] w-[520px] flex-col p-0 sm:rounded-[var(--radius)]",e(x),{"border-border border":e(B),"shadow-3xl":!e(B),"left-0 top-0 size-full max-h-full !translate-x-0 !translate-y-0":le.value,"top-1/2 !-translate-y-1/2":e($)&&!le.value,"duration-300":!e(Re),hidden:ie.value})),"force-mount":Ue.value,modal:e(Ie),open:(E=e(r))==null?void 0:E.isOpen,"show-close":e(Z),"z-index":e(Fe),"overlay-blur":e(Pe),"close-class":"top-3",onCloseAutoFocus:ve,onClosed:We,"close-disabled":e(D),onEscapeKeyDown:He,onFocusOutside:ve,onInteractOutside:Ye,onOpenAutoFocus:je,onOpened:g[2]||(g[2]=()=>{var S;return(S=l.modalApi)==null?void 0:S.onOpened()}),onPointerDownOutside:Ke},{default:y(()=>[F(e(Fo),{ref_key:"headerRef",ref:u,class:L(e(O)("px-5 py-4",{"border-b":e(B),hidden:!e(ae),"cursor-move select-none":ye.value},e(Ee)))},{default:y(()=>[e(J)?(p(),h(e(Oe),{key:0,class:"text-left"},{default:y(()=>[b(l.$slots,"title",{},()=>[Y(H(e(J))+" ",1),e(he)?b(l.$slots,"titleTooltip",{key:0},()=>[F(e(Oo),{"trigger-class":"pb-1"},{default:y(()=>[Y(H(e(he)),1)]),_:1})]):k("",!0)])]),_:3})):k("",!0),e(P)?(p(),h(e(_e),{key:1},{default:y(()=>[b(l.$slots,"description",{},()=>[Y(H(e(P)),1)])]),_:3})):k("",!0),!e(J)||!e(P)?(p(),h(e(Mo),{key:2},{default:y(()=>[e(J)?k("",!0):(p(),h(e(Oe),{key:0})),e(P)?k("",!0):(p(),h(e(_e),{key:1}))]),_:1})):k("",!0)]),_:3},8,["class"]),ro("div",{ref_key:"wrapperRef",ref:i,class:L(e(O)("relative min-h-40 flex-1 overflow-y-auto p-3",e(se),{"pointer-events-none":e(me)||e(D)}))},[b(l.$slots,"default")],2),e(me)||e(D)?(p(),h(e(So),{key:0,spinning:""})):k("",!0),e(z)?(p(),h(e(xo),{key:1,class:"hover:bg-accent hover:text-accent-foreground text-foreground/80 flex-center absolute right-10 top-3 hidden size-6 rounded-full px-1 text-lg opacity-70 transition-opacity hover:opacity-100 focus:outline-none disabled:pointer-events-none sm:block",onClick:Ne},{default:y(()=>[e(A)?(p(),h(e(Eo),{key:0,class:"size-3.5"})):(p(),h(e(To),{key:1,class:"size-3.5"}))]),_:1})):k("",!0),e(U)?(p(),h(e(Vo),{key:2,ref_key:"footerRef",ref:C,class:L(e(O)("flex-row items-center justify-end p-2",{"border-t":e(B)},e(W)))},{default:y(()=>[b(l.$slots,"prepend-footer"),b(l.$slots,"footer",{},()=>[e(ze)?(p(),h(Be(e(t).DefaultButton||e(we)),{key:0,variant:"ghost",disabled:e(D),onClick:g[0]||(g[0]=()=>{var S;return(S=l.modalApi)==null?void 0:S.onCancel()})},{default:y(()=>[b(l.$slots,"cancelText",{},()=>[Y(H(e(w)||e(a)("cancel")),1)])]),_:3},8,["disabled"])):k("",!0),b(l.$slots,"center-footer"),e(Ve)?(p(),h(Be(e(t).PrimaryButton||e(we)),{key:1,disabled:e(ee),loading:e(oe)||e(D),onClick:g[1]||(g[1]=()=>{var S;return(S=l.modalApi)==null?void 0:S.onConfirm()})},{default:y(()=>[b(l.$slots,"confirmText",{},()=>[Y(H(e(te)||e(a)("confirm")),1)])]),_:3},8,["disabled","loading"])):k("",!0)]),b(l.$slots,"append-footer")]),_:3},8,["class"])):k("",!0)]),_:3},8,["append-to","class","force-mount","modal","open","show-close","z-index","overlay-blur","close-disabled"])]}),_:3},8,["open"])}}});class No{constructor(o={}){X(this,"sharedData",{payload:{}});X(this,"store");X(this,"api");X(this,"state");const r=o,{connectedComponent:t,onBeforeClose:n,onCancel:i,onClosed:c,onConfirm:u,onOpenChange:C,onOpened:m}=r,a=R(r,["connectedComponent","onBeforeClose","onCancel","onClosed","onConfirm","onOpenChange","onOpened"]),v={bordered:!0,centered:!1,class:"",closeOnClickModal:!0,closeOnPressEscape:!0,confirmDisabled:!1,confirmLoading:!1,contentClass:"",destroyOnClose:!0,draggable:!1,footer:!0,footerClass:"",fullscreen:!1,fullscreenButton:!0,header:!0,headerClass:"",isOpen:!1,loading:!1,modal:!0,openAutoFocus:!1,showCancelButton:!0,showConfirmButton:!0,title:""};this.store=new Do(f(f({},v),a),{onUpdate:()=>{var B,w,$;const d=this.store.state;(d==null?void 0:d.isOpen)===((B=this.state)==null?void 0:B.isOpen)?this.state=d:(this.state=d,($=(w=this.api).onOpenChange)==null||$.call(w,!!(d!=null&&d.isOpen)))}}),this.state=this.store.state,this.api={onBeforeClose:n,onCancel:i,onClosed:c,onConfirm:u,onOpenChange:C,onOpened:m},io(this)}close(){return N(this,null,function*(){var t,n,i;((i=yield(n=(t=this.api).onBeforeClose)==null?void 0:n.call(t))!=null?i:!0)&&this.store.setState(c=>I(f({},c),{isOpen:!1,submitting:!1}))})}getData(){var o,t;return(t=(o=this.sharedData)==null?void 0:o.payload)!=null?t:{}}lock(o=!0){return this.setState({submitting:o})}onCancel(){var o,t;this.api.onCancel?(t=(o=this.api).onCancel)==null||t.call(o):this.close()}onClosed(){var o,t;this.state.isOpen||(t=(o=this.api).onClosed)==null||t.call(o)}onConfirm(){var o,t;(t=(o=this.api).onConfirm)==null||t.call(o)}onOpened(){var o,t;this.state.isOpen&&((t=(o=this.api).onOpened)==null||t.call(o))}open(){this.store.setState(o=>I(f({},o),{isOpen:!0}))}setData(o){return this.sharedData.payload=o,this}setState(o){return co(o)?this.store.setState(o):this.store.setState(t=>f(f({},t),o)),this}unlock(){return this.lock(!1)}}const Me=Symbol("VBEN_MODAL_INJECT"),Yo={};function Jo(s={}){var m;const{connectedComponent:o}=s;if(o){const a=De({}),v=_(!0),r=M((d,{attrs:B,slots:w})=>($e(Me,{extendApi(x){Object.setPrototypeOf(a,x)},options:s,reCreateModal(){return N(this,null,function*(){v.value=!1,yield fe(),v.value=!0})}}),Ho(a,f(f(f({},d),B),w)),()=>ke(v.value?o:"div",f(f({},d),B),w)),{name:"VbenParentModal",inheritAttrs:!1});return uo(()=>{var d;(d=a==null?void 0:a.close)==null||d.call(a)}),[r,a]}const t=xe(Me,{}),n=f(f(f({},Yo),t.options),s);n.onOpenChange=a=>{var v,r,d;(v=s.onOpenChange)==null||v.call(s,a),(d=(r=t.options)==null?void 0:r.onOpenChange)==null||d.call(r,a)};const i=n.onClosed;n.onClosed=()=>{var a;i==null||i(),n.destroyOnClose&&((a=t.reCreateModal)==null||a.call(t))};const c=new No(n),u=c;u.useStore=a=>$o(c.store,a);const C=M((a,{attrs:v,slots:r})=>()=>ke(Xo,I(f(f({},a),v),{modalApi:u}),r),{name:"VbenModal",inheritAttrs:!1});return(m=t.extendApi)==null||m.call(t,u),[C,u]}function Ho(s,o){return N(this,null,function*(){var i;if(!o||Object.keys(o).length===0)return;yield fe();const t=(i=s==null?void 0:s.store)==null?void 0:i.state;if(!t)return;const n=new Set(Object.keys(t));for(const c of Object.keys(o))n.has(c)&&!["class"].includes(c)&&console.warn(`[Vben Modal]: When 'connectedComponent' exists, do not set props or slots '${c}', which will increase complexity. If you need to modify the props of Modal, please use useVbenModal or api.`)})}export{Jo as u};
