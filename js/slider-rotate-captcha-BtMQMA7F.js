var se=Object.defineProperty,ae=Object.defineProperties;var ne=Object.getOwnPropertyDescriptors;var Z=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var G=(o,n,i)=>n in o?se(o,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):o[n]=i,I=(o,n)=>{for(var i in n||(n={}))oe.call(n,i)&&G(o,i,n[i]);if(Z)for(var i of Z(n))ie.call(n,i)&&G(o,i,n[i]);return o},F=(o,n)=>ae(o,ne(n));import{af as re,aW as le,aX as ce,_ as ue,$ as z,ag as fe,E as de}from"./bootstrap-CRMPbCAg.js";import{E as me}from"./el-card-D5ScM1yk.js";import{e as $,c as v,h as _,j as g,q as R,p as P,f as b,r as K,n as k,y as S,u as f,I as T,v as j,x as pe,t as J,a2 as O,a3 as Q,J as Y,w as ee,$ as ge,an as te,m as he,R as U,l as N,k as H,z as ve,V as ye,W as xe,M as be}from"../jse/index-index-BLEn1CMS.js";import{_ as _e}from"./page.vue_vue_type_script_setup_true_lang-Jfv2R4fZ.js";const Se=$({__name:"spine-text",props:{animationDuration:{default:2},animationIterationCount:{default:"infinite"}},setup(o){const n=v(()=>({animation:`shine ${o.animationDuration}s linear ${o.animationIterationCount}`}));return(i,r)=>(g(),_("div",{style:R(n.value),class:"vben-spine-text !bg-clip-text text-transparent"},[P(i.$slots,"default")],4))}}),we=$({__name:"slider-captcha-action",props:{actionStyle:{},isPassing:{type:Boolean},toLeft:{type:Boolean}},setup(o,{expose:n}){const i=o,r=b("actionRef"),d=K("0"),c=v(()=>{const{actionStyle:u}=i;return F(I({},u),{left:d.value})}),e=v(()=>Number.parseInt(d.value)>10&&!i.isPassing);return n({getEl:()=>r.value,getStyle:()=>{var u;return(u=r==null?void 0:r.value)==null?void 0:u.style},setLeft:u=>{d.value=u}}),(u,w)=>(g(),_("div",{ref_key:"actionRef",ref:r,class:k([{"transition-width !left-0 duration-300":u.toLeft,"rounded-md":e.value},"bg-background dark:bg-accent absolute left-0 top-0 flex h-full cursor-move items-center justify-center px-3.5 shadow-md"]),style:R(c.value),name:"captcha-action"},[S(f(re),{"is-passing":u.isPassing,class:"text-foreground/60 size-4"},{default:T(()=>[P(u.$slots,"icon",{},()=>[u.isPassing?(g(),j(f(ce),{key:1})):(g(),j(f(le),{key:0}))])]),_:3},8,["is-passing"])],6))}}),Re=$({__name:"slider-captcha-bar",props:{barStyle:{},toLeft:{type:Boolean}},setup(o,{expose:n}){const i=o,r=b("barRef"),d=K("0"),c=v(()=>{const{barStyle:e}=i;return F(I({},e),{width:d.value})});return n({getEl:()=>r.value,setWidth:e=>{d.value=e}}),(e,u)=>(g(),_("div",{ref_key:"barRef",ref:r,class:k([e.toLeft&&"transition-width !w-0 duration-300","bg-success absolute h-full"]),style:R(c.value)},null,6))}}),Te=$({__name:"slider-captcha-content",props:{contentStyle:{},isPassing:{type:Boolean},successText:{},text:{}},setup(o,{expose:n}){const i=o,r=b("contentRef"),d=v(()=>{const{contentStyle:c}=i;return I({},c)});return n({getEl:()=>r.value}),(c,e)=>(g(),_("div",{ref_key:"contentRef",ref:r,class:k([{[c.$style.success]:c.isPassing},"absolute top-0 flex size-full select-none items-center justify-center text-xs"]),style:R(d.value)},[P(c.$slots,"text",{},()=>[S(f(Se),{class:"flex h-full items-center"},{default:T(()=>[pe(J(c.isPassing?c.successText:c.text),1)]),_:1})])],6))}}),$e="_success_fwxn1_2",De={success:$e},Me={$style:De},Pe=ue(Te,[["__cssModules",Me]]),ke=$({__name:"index",props:O({class:{},actionStyle:{default:()=>({})},barStyle:{default:()=>({})},contentStyle:{default:()=>({})},wrapperStyle:{default:()=>({})},isSlot:{type:Boolean,default:!1},successText:{default:""},text:{default:""}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:O(["end","move","start","success"],["update:modelValue"]),setup(o,{expose:n,emit:i}){const r=o,d=i,c=Q(o,"modelValue"),e=Y({endTime:0,isMoving:!1,isPassing:!1,moveDistance:0,startTime:0,toLeft:!1});n({resume:M});const u=b("wrapperRef"),w=b("barRef"),E=b("contentRef"),y=b("actionRef");ee(()=>e.isPassing,t=>{if(t){const{endTime:s,startTime:a}=e,l=(s-a)/1e3;d("success",{isPassing:t,time:l.toFixed(1)}),c.value=t}}),ge(()=>{e.isPassing=!!c.value});function L(t){return"pageX"in t?t.pageX:"touches"in t&&t.touches[0]?t.touches[0].pageX:0}function W(t){e.isPassing||y.value&&(d("start",t),e.moveDistance=L(t)-Number.parseInt(y.value.getStyle().left.replace("px","")||"0",10),e.startTime=Date.now(),e.isMoving=!0)}function X(t){var m,p,h;const s=(p=(m=u.value)==null?void 0:m.offsetWidth)!=null?p:220,a=(h=t==null?void 0:t.offsetWidth)!=null?h:40,l=s-a-6;return{actionWidth:a,offset:l,wrapperWidth:s}}function D(t){const{isMoving:s,moveDistance:a}=e;if(s){const l=f(y),m=f(w);if(!l||!m)return;const{actionWidth:p,offset:h,wrapperWidth:C}=X(l.getEl()),x=L(t)-a;d("move",{event:t,moveDistance:a,moveX:x}),x>0&&x<=h?(l.setLeft(`${x}px`),m.setWidth(`${x+p/2}px`)):x>h&&(l.setLeft(`${C-p}px`),m.setWidth(`${C-p/2}px`),r.isSlot||B())}}function V(t){const{isMoving:s,isPassing:a,moveDistance:l}=e;if(s&&!a){d("end",t);const m=y.value,p=f(w);if(!m||!p)return;const h=L(t)-l,{actionWidth:C,offset:x,wrapperWidth:q}=X(m.getEl());h<x?r.isSlot?setTimeout(()=>{if(c.value){const A=f(E);A&&(A.getEl().style.width=`${Number.parseInt(p.getEl().style.width)}px`)}else M()},0):M():(m.setLeft(`${q-C}px`),p.setWidth(`${q-C/2}px`),B()),e.isMoving=!1}}function B(){if(r.isSlot){M();return}e.endTime=Date.now(),e.isPassing=!0,e.isMoving=!1}function M(){e.isMoving=!1,e.isPassing=!1,e.moveDistance=0,e.toLeft=!1,e.startTime=0,e.endTime=0;const t=f(y),s=f(w),a=f(E);!t||!s||!a||(a.getEl().style.width="100%",e.toLeft=!0,te(()=>{e.toLeft=!1,t.setLeft("0"),s.setWidth("0")},300))}return(t,s)=>(g(),_("div",{ref_key:"wrapperRef",ref:u,class:k(f(he)("border-border bg-background-deep relative flex h-10 w-full items-center overflow-hidden rounded-md border text-center",r.class)),style:R(t.wrapperStyle),onMouseleave:V,onMousemove:D,onMouseup:V,onTouchend:V,onTouchmove:D},[S(Re,{ref_key:"barRef",ref:w,"bar-style":t.barStyle,"to-left":e.toLeft},null,8,["bar-style","to-left"]),S(Pe,{ref_key:"contentRef",ref:E,"content-style":t.contentStyle,"is-passing":e.isPassing,"success-text":t.successText||f(z)("ui.captcha.sliderSuccessText"),text:t.text||f(z)("ui.captcha.sliderDefaultText")},U({_:2},[t.$slots.text?{name:"text",fn:T(()=>[P(t.$slots,"text",{isPassing:e.isPassing})]),key:"0"}:void 0]),1032,["content-style","is-passing","success-text","text"]),S(we,{ref_key:"actionRef",ref:y,"action-style":t.actionStyle,"is-passing":e.isPassing,"to-left":e.toLeft,onMousedown:W,onTouchstart:W},U({_:2},[t.$slots.actionIcon?{name:"icon",fn:T(()=>[P(t.$slots,"actionIcon",{isPassing:e.isPassing})]),key:"0"}:void 0]),1032,["action-style","is-passing","to-left"])],38))}}),Ee={class:"relative flex flex-col items-center"},Le=["src"],We={class:"absolute bottom-3 left-0 z-10 block h-7 w-full text-center text-xs leading-[30px] text-white"},Ve={key:1,class:"bg-black/30"},Be=$({__name:"index",props:O({diffDegree:{default:20},imageSize:{default:260},imageWrapperStyle:{},maxDegree:{default:300},minDegree:{default:120},src:{default:""},defaultTip:{default:""}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:O(["success"],["update:modelValue"]),setup(o,{expose:n,emit:i}){const r=o,d=i,c=b("slideBarRef"),e=Y({currentRotate:0,dragging:!1,endTime:0,imgStyle:{},isPassing:!1,randomRotate:0,showTip:!1,startTime:0,toOrigin:!1}),u=Q(o,"modelValue");ee(()=>e.isPassing,s=>{if(s){const{endTime:a,startTime:l}=e,m=(a-l)/1e3;d("success",{isPassing:s,time:m.toFixed(1)})}u.value=s});const w=v(()=>{const{imageSize:s,imageWrapperStyle:a}=r;return I({height:`${s}px`,width:`${s}px`},a)}),E=v(()=>{const{maxDegree:s,minDegree:a}=r;return a>s&&console.warn("minDegree should not be greater than maxDegree"),a===s?Math.floor(1+Math.random()*1)/10+1:1});function y(){e.startTime=Date.now()}function L(s){e.dragging=!0;const{imageSize:a,maxDegree:l}=r,{moveX:m}=s,p=a;if(p===0)return;const h=Math.ceil(m/p*1.5*l*f(E));e.currentRotate=h,D(e.randomRotate-h)}function W(){const{maxDegree:s,minDegree:a}=r,l=Math.floor(a+Math.random()*(s-a));e.randomRotate=l,D(l)}function X(){const{currentRotate:s,randomRotate:a}=e,{diffDegree:l}=r;Math.abs(a-s)>=(l||20)?(D(a),e.toOrigin=!0,te(()=>{e.toOrigin=!1,e.showTip=!0},300)):V(),e.showTip=!0,e.dragging=!1}function D(s){e.imgStyle={transform:`rotateZ(${s}deg)`}}function V(){e.isPassing=!0,e.endTime=Date.now()}function B(){e.showTip=!1;const s=f(c);s&&(e.isPassing=!1,s.resume(),W())}const M=v(()=>e.toOrigin?["transition-transform duration-300"]:[]),t=v(()=>e.isPassing?z("ui.captcha.sliderRotateSuccessTip",[((e.endTime-e.startTime)/1e3).toFixed(1)]):z("ui.captcha.sliderRotateFailTip"));return n({resume:B}),(s,a)=>(g(),_("div",Ee,[N("div",{style:R(w.value),class:"border-border relative cursor-pointer overflow-hidden rounded-full border shadow-md"},[N("img",{class:k([M.value,"w-full rounded-full"]),src:s.src,style:R(e.imgStyle),alt:"verify",onClick:B,onLoad:W},null,46,Le),N("div",We,[e.showTip?(g(),_("div",{key:0,class:k({"bg-success/80":e.isPassing,"bg-destructive/80":!e.isPassing})},J(t.value),3)):H("",!0),e.dragging?H("",!0):(g(),_("div",Ve,J(s.defaultTip||f(z)("ui.captcha.sliderRotateDefaultTip")),1))])],4),S(ke,{ref_key:"slideBarRef",ref:c,modelValue:u.value,"onUpdate:modelValue":a[0]||(a[0]=l=>u.value=l),class:"mt-5","is-slot":"",onEnd:X,onMove:L,onStart:y},U({_:2},[ve(s.$slots,(l,m)=>({name:m,fn:T(p=>[P(s.$slots,m,ye(xe(p)))])}))]),1032,["modelValue"])]))}}),Ce={class:"flex items-center justify-center p-4"},Fe=$({__name:"slider-rotate-captcha",setup(o){const n=fe();function i(){de.success("success!")}const r=v(()=>{var d;return((d=n.userInfo)==null?void 0:d.avatar)||be.app.defaultAvatar});return(d,c)=>(g(),j(f(_e),{description:"用于前端简单的拖动校验场景",title:"滑块旋转校验"},{default:T(()=>[S(f(me),{class:"mb-5",title:"基本示例"},{default:T(()=>[N("div",Ce,[S(f(Be),{src:r.value,onSuccess:i},null,8,["src"])])]),_:1})]),_:1}))}});export{Fe as default};
